<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <link href="style/css/bootstrap-theme.css" rel="stylesheet" type="text/css"/>
        <link href="style/css/bootstrap.css" rel="stylesheet" type="text/css"/>
        <script src="style/js/bootstrap.js" type="text/javascript"></script>
        <script src="style/js/jquery-3.1.1.js" type="text/javascript"></script>
        <script src="style/js/bootstrap.min.js" type="text/javascript"></script>
        <script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.min.js"></script>
        <script type="text/javascript">
            $(function () {

                var url = "ws://localhost:8080/CA2/noteSocket";

                var socket = new WebSocket(url);
                socket.onopen = function () {
                    alert("Conn");
                }
                socket.onclose = function () {
                    alert("Diconn");
                }
                socket.onmessage = function (evt) {
                    // {message: "the message" , timestamp: "time" }
                    alert("Received event data "+evt.data);
                    var msg = JSON.parse(evt.data);
                    alert("Message : "+msg.message);
                    var note = msg.message;
                    alert("title : " + JSON.parse(note).title);
                    
                    var title = JSON.parse(note).title;
                    var category = JSON.parse(note).category;
                    var content = JSON.parse(note).content;
                    document.getElementById("forsale-Table").innerHTML = '<tr><td class="">'+title+'</td><td class="">'+category+'</td><td class="">'+content+'</td>     <td class="">'+'DATE_HERE</td>                                      </tr> ' +document.getElementById("forsale-tbl").innerHTML
//                    document.getElementById("title").innerHTML = title;
//                    document.getElementById("category").innerHTML = category;
//                    document.getElementById("content").innerHTML = content;
                    
                    
                }
            });

        </script>    
    </h:head>   

    <h:body>        
        <h:form>   
            <nav class="navbar navbar-inverse navbar-static-top">
                <div class="container">
                    <div class="navbar-header">			
                        <p class="navbar-text">Notice Board</p>   
                    </div>
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav navbar-right">

                            <li><a href="/CA2/faces/login.xhtml">Login/Register</a></li>	

                        </ul>
                    </div>
                </div>
            </nav>  


            <div id="exTab1" class="container">	
                <ul  class="nav nav-pills">
                    <li class="active">
                        <a  href="#1a" data-toggle="tab">All</a>
                    </li>
                    <li><a href="#2a" data-toggle="tab">Social</a>
                    </li>
                    <li><a href="#3a" data-toggle="tab">For Sale</a>
                    </li>
                    <li><a href="#4a" data-toggle="tab">Jobs</a>
                    </li>
                    <li><a href="#5a" data-toggle="tab">Tuition</a>
                    </li>
                </ul>

                <div class="tab-content clearfix">
                    <div class="tab-pane active" id="1a">
                        <h3>
                            <table class="table" style="table-layout: fixed;font-size: small" id="forsale-Table" border="1">
                                <tr>
                                    <th class="">Title</th>
                                    <th class="">Category</th>
                                    <th class="">Content</th>
                                    <th class="">Date</th>
                                </tr>
                            <tbody>
                                <ui:repeat var="note" value="#{noteView.allNotes}">
                                    <tr>
                                        <td class="">#{note.title}</td>
                                        <td class="">#{note.category}</td>
                                        <td class="">#{note.content}</td>
                                        <td class="">#{note.date}</td>
                                      </tr>
                                </ui:repeat>
                            </tbody>
                            </table>
                        </h3>
                    </div>



                    <div class="tab-pane" id="2a">
                        <h3>
                            <table class="table" style="table-layout: fixed;font-size: small" id="forsale-Table" border="1">
                                <tr>
                                    <th class="">Title</th>
                                    <th class="">Category</th>
                                    <th class="">Content</th>
                                    <th class="">Date</th>
                                </tr>
                            <tbody>
                                <ui:repeat var="note" value="#{noteView.allNotes}">
                                    <c:if test="${note.category == 'Social'}">
                                    <tr>
                                        <td class="">#{note.title}</td>
                                        <td class="">#{note.category}</td>
                                        <td class="">#{note.content}</td>
                                        <td class="">#{note.date}</td>
                                    </tr>
                                    </c:if>
                                </ui:repeat>
                            </tbody>
                            </table>
                        </h3>
                    </div>
                    <div class="tab-pane" id="3a">
                        <h3>
                            <table class="table" style="table-layout: fixed;font-size: small" id="forsale-Table" border="1">
                                <tr>
                                    <th class="">Title</th>
                                    <th class="">Category</th>
                                    <th class="">Content</th>
                                    <th class="">Date</th>
                                </tr>
                            <tbody>
                                <ui:repeat var="note" value="#{noteView.allNotes}">
                                    <c:if test="${note.category eq 'For Sale'}">
                                    <tr>
                                        <td class="">#{note.title}</td>
                                        <td class="">#{note.category}</td>
                                        <td class="">#{note.content}</td>
                                        <td class="">#{note.date}</td>
                                      </tr>
                                    </c:if>
                                </ui:repeat>
                            </tbody>
                            </table>
                        </h3>
                    </div>
                    <div class="tab-pane" id="4a">
                        <h3>
                            <table class="table" style="table-layout: fixed;font-size: small" id="forsale-Table" border="1">
                                <tr>
                                    <th class="order-table-header">Title</th>
                                    <th class="order-table-header">Category</th>
                                    <th class="order-table-header">Content</th>
                                    <th class="order-table-header">Date</th>
                                </tr>
                            <tbody>
                                <ui:repeat var="note" value="#{noteView.allNotes}">
                                    
                                    <tr>
                                        <td class="">#{note.title}</td>
                                        <td class="">#{note.category}</td>
                                        <td class="">#{note.content}</td>
                                        <td class="">#{note.date}</td>
                                      </tr>
                                </ui:repeat>
                            </tbody>
                            </table>
                        </h3>
                    </div>
                    <div class="tab-pane" id="5a">
                        <h3>
                            <table class="table" style="table-layout: fixed;font-size: small" id="forsale-Table" border="1">
                                <tr>
                                    <th class="order-table-header">Title</th>
                                    <th class="order-table-header">Category</th>
                                    <th class="order-table-header">Content</th>
                                    <th class="order-table-header">Date</th>
                                </tr>
                            <tbody>
                                <ui:repeat var="note" value="#{noteView.allNotes}">
                                    
                                    <tr>
                                        <td class="">#{note.title}</td>
                                        <td class="">#{note.category}</td>
                                        <td class="">#{note.content}</td>
                                        <td class="">#{note.date}</td>
                                      </tr>
                                </ui:repeat>
                            </tbody>
                            </table>
                        </h3>
                    </div>

                </div>
            </div>
        </h:form> 
    </h:body>
</html>


